# v0.1.3 更新日誌

發布日期: 2025-10-22

## 新增功能

### 圖片全螢幕預覽功能
- ✨ **雙擊圖片預覽**: 雙擊便利貼中的圖片可開啟全螢幕預覽
- 🔍 **Ctrl + 滾輪縮放**: 在預覽模式下按住 Ctrl 並滾動滑鼠滾輪可縮放圖片
  - 縮放範圍: 0.5x ~ 5x
  - 縮放步進: 0.1x
  - 即時顯示縮放比例
- 🎨 **半透明背景**: 預覽視窗背景為半透明黑色 (50% 不透明度),可看到桌面內容
- ⌨️ **多種關閉方式**:
  - 點擊圖片外的背景區域
  - 按下 ESC 鍵
- 📺 **全螢幕覆蓋**: 預覽視窗覆蓋整個螢幕,而非僅應用程式視窗
- ⏳ **載入動畫**: 圖片載入時顯示旋轉的載入動畫,避免顯示空白或 alt 文字
- 🚀 **無閃爍開啟**: 預覽視窗在圖片完全載入後才顯示,避免閃爍

### 網址自動轉換改進
- 🔗 **支援 www. 開頭的網址**: 現在 `www.example.com` 格式的網址也會自動轉換為可點擊連結
  - 自動添加 `https://` 前綴
  - 與 `http://` 和 `https://` 格式一致的處理方式

## 功能優化

### 換行功能修復
- 🐛 **修復換行被取消問題**: 解決了輸入換行後自動被取消的問題
- ⚡ **優化 linkify 邏輯**: 只在包含網址時才執行網址轉換,減少不必要的 DOM 操作
- ⏱️ **延長轉換延遲**: 將網址轉換延遲從 1 秒延長至 2 秒,給使用者更充足的輸入時間

## 技術改進

### 圖片預覽架構
- 🏗️ **多頁面應用**: 配置 Vite 支援多 HTML 頁面 (主視窗 + 預覽視窗)
- 📡 **Tauri 事件系統**: 使用 Tauri 事件系統在視窗間傳遞圖片數據,避免 URL 長度限制
- 🔐 **權限管理**: 為預覽視窗添加獨立的 capability 配置
- 💾 **效能優化**: 圖片載入完成後立即清理暫存數據

### 網址轉換架構
- 🎯 **條件式執行**: 檢測到網址才執行轉換,避免無謂的處理
- 🔄 **改進的比較邏輯**: 優化內容變更檢測,避免不必要的 innerHTML 更新

## 檔案變更

### 新增檔案
- `src/preview.html` - 圖片預覽視窗 HTML
- `src/preview.ts` - 圖片預覽視窗邏輯
- `change_log/v0.1.3.md` - 本更新日誌

### 修改檔案
- `src/image.ts` - 新增圖片預覽功能
- `src/linkify.ts` - 更新 URL 正則表達式支援 www.
- `src/main.ts` - 優化 linkify 執行邏輯
- `vite.config.ts` - 配置多頁面應用
- `src-tauri/tauri.conf.json` - 新增預覽視窗權限配置

## 使用說明

### 圖片預覽
1. 在便利貼中插入圖片 (貼上或拖放)
2. 雙擊圖片開啟全螢幕預覽
3. 在預覽模式下:
   - 按住 Ctrl 並滾動滑鼠滾輪可縮放圖片
   - 點擊圖片外的區域或按 ESC 關閉預覽

### 網址轉換
- 直接輸入網址,支援以下格式:
  - `http://example.com`
  - `https://example.com`
  - `www.example.com` (新增)
- 等待 2 秒後自動轉換為可點擊連結

## 已知問題
- 無

## 下一版本計畫
- 待定
